#
# 2D Bubble-Column Fluidized Bed Simulation
#
#  S. Modeler                  Today
# 
# Details see: Chem. Eng. Science 54 (1999) 5091-5099.
# This is a 2D version of the case ref. above.
#
  RUN_NAME = 'R'
  DESCRIPTION = 'water-air simulation'
  RUN_TYPE = 'new'
  UNITS = 'cgs'
  TIME  = 0.0    TSTOP = 3.0    DT = 1.0E-2
  DT_MAX = 1E-1  DT_MIN = 1d-8
  ENERGY_EQ = .FALSE.
  SPECIES_EQ = .FALSE.    .FALSE.
  
# 
# Geometry Section 
# 
  COORDINATES = 'CARTESIAN'
#
  XLENGTH  = 20.0    IMAX = 40
  YLENGTH  = 45.0    JMAX = 90
  ZLENGTH  = 5       NO_K = .TRUE.
#
  NORM_G = 0.0 
  TOL_RESID = 1e-4
  MAX_NIT = 50
  DETECT_STALL = .TRUE. !.FALSE.

#  DISCRETIZE     =  9*2
#  DEF_COR = .TRUE.

  LEQ_IT = 9*200
  LEQ_TOL = 9*1D-08
#
#
# Water-phase or continuous-phase Section
# 
  MU_g0 = 0.9E-2
  RO_G0 = 1.0
  Mu_gmax = 1.E+03
  K_EPSILON = .TRUE.
  P_Ref = 1.01E6
#
# air bubble-phase Section (disperse phase)
# 
  ADDED_MASS = .TRUE. ! use added (virtual) mass
  M_AM       = 1      ! dispersed phase where virtual mass force is applied.
  DRAG_TYPE  = 'WEN_YU' !
  MODEL_B = .FALSE.
  CLOSE_PACKED(1) = .F. ! bubble-phase can reach near 100% vol. fraction.
  SCHAEFFER = .FALSE.   ! frictional stresses may be used with solid particles only.
  MU_S0   = 1.8E-4      ! constant 'gas' bubble viscosity
  RO_s0    = 0.00118     ! constant bubble density
  D_p0    = 0.2         ! constant bubble diameter

  e       = 0.8        ! unecessary, will not be used
  Phi     = 0.0        ! unecessary, will not be used
  EP_star = 0.35        ! unecessary, will not be used
#
# Initial Conditions Section
#
       !              Bed
  IC_X_w           =  0.0
  IC_X_e           =  20.0
  IC_Y_s           =  0.0
  IC_Y_n           =  45.0
  IC_Z_b           =  0.0
  IC_Z_t           =  5

  IC_EP_g          =  1.0

  IC_U_g           =  0.0
  IC_V_g           =  0.0
  IC_W_g           =  0.0

  IC_U_s(1,1)      =  0.0
  IC_V_s(1,1)      =  0.0
  IC_W_s(1,1)      =  0.0

  IC_P_g(1)          = 1.01E6
  IC_T_g(1)           = 300.0
  
  IC_K_Turb_G(1)      = 10.
  IC_E_Turb_G(1)      = 100.

#
#  Boundary Conditions Section
# 
       !              Jet        Exit
  BC_X_w           =  8.5        0.0
  BC_X_e           =  11.5       20.0
  BC_Y_s           =  0.0        45.0
  BC_Y_n           =  0.0        45.0
  BC_Z_b           =  0.0        0.0
  BC_Z_t           =  5.0        5.0

  BC_TYPE          = 'MI'       'PO'

  BC_EP_g          =  0.9

  BC_U_g           =  0.0
  BC_V_g           =  0.0
  BC_W_g           =  0.0
#  BC_VOLFLOW_s(1,1)= @(3*13.33333) !@(48*1000.0/3600.0)
  BC_U_s(1,1)           =  0.0
  BC_V_s(1,1)           =  44.444444444444444
  BC_W_s(1,1)           =  0.0
#
  BC_P_g           = 1.01E6   1.01E6
  BC_T_g           = 300.0    300.0    
  
  BC_K_Turb_G(1)      = 1.
  BC_E_Turb_G(1)      = 10.
#
###############################################
#
  BC_X_w(4) = 0.
  BC_X_e(4) = 0.
  BC_Y_s(4) = 0.
  BC_Y_n(4) = 45. 
  BC_Z_b(4) = 0.0
  BC_Z_t(4) = 5.0
  BC_TYPE(4) = 'PAR_SLIP_WALL'
  !
  BC_Uw_s(4,1) = 0.0 	
  BC_Vw_s(4,1) = 0.0
#  BC_hw_s(4,1) = 0.0 !no slip for air-bubbles
  BC_Uw_g(4) = 0.0
  BC_Vw_g(4) = 0.0
  BC_Ww_g(4) = 0.0
  BC_Ww_s(4,1) = 0.0  !wall functions for water-phase    
  BC_JJ_PS(4) = 0
#
###############################################
#
  BC_X_w(5) = 20.
  BC_X_e(5) = 20.
  BC_Y_s(5) = 0.
  BC_Y_n(5) = 45. 
  BC_Z_b(5) = 0.0
  BC_Z_t(5) = 5.0
  BC_TYPE(5) = 'PAR_SLIP_WALL'
  !
  BC_Uw_s(5,1) = 0.0 	
  BC_Vw_s(5,1) = 0.0
#  BC_hw_s(5,1) = 0.0
  BC_Uw_g(5) = 0.0
  BC_Vw_g(5) = 0.0
  BC_Ww_g(5) = 0.0
  BC_Ww_s(5,1) = 0.0  	    
  BC_JJ_PS(5) = 0
#
###############################################
#
  BC_X_w(6) = 0.
  BC_X_e(6) = 20.
  BC_Y_s(6) = 0.
  BC_Y_n(6) = 45. 
  BC_Z_b(6) = 0.0
  BC_Z_t(6) = 0.0
  BC_TYPE(6) = 'DUMMY'
  !
  BC_Uw_s(6,1) = 0.0 	
  BC_Vw_s(6,1) = 0.0
#  BC_hw_s(6,1) = 0.0
  BC_Uw_g(6) = 0.0
  BC_Vw_g(6) = 0.0
  BC_Ww_g(6) = 0.0
  BC_Ww_s(6,1) = 0.0  	    
  BC_JJ_PS(6) = 0
#
###############################################
#
  BC_X_w(7) = 0.
  BC_X_e(7) = 20.
  BC_Y_s(7) = 0.
  BC_Y_n(7) = 45. 
  BC_Z_b(7) = 5.0
  BC_Z_t(7) = 5.0
  BC_TYPE(7) = 'DUMMY'
  !
  BC_Uw_s(7,1) = 0.0 	
  BC_Vw_s(7,1) = 0.0
#  BC_hw_s(7,1) = 0.0
  BC_Uw_g(7) = 0.0
  BC_Vw_g(7) = 0.0
  BC_Ww_g(7) = 0.0
  BC_Ww_s(7,1) = 0.0  	    
  BC_JJ_PS(7) = 0
#
###############################################
# 
#  Output Control
#
  RES_DT = 0.1
        ! 
        ! EP_g P_g       U_g  U_s  ROP_s     T_g  X_g
        !      P_star    V_g  V_s            T_s1 X_s    Theta  Scalar
        !                W_g  W_s            T_s2 
  SPX_DT = 0.1 0.1      0.1  0.1  100.      100. 100.   100.0  100.0 0.1 0.1
  RESID_STRING = 'P0' 'U0' 'V0' 'U1' 'V1' 'K0'

  NLOG   = 100
  full_log = .true.
