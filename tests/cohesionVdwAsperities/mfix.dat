
! Simple 3-particle DEM case with VDW cohesive forces      
      
                                 
!  ---------------------- Run-control section ------------------------------------
  DESCRIPTION   = 'vdW Cohesion'              
  RUN_NAME    = 'R'
  RUN_TYPE   = 'new'                 
  UNITS   ='cgs'    
  TIME     = 0 !start time  
  TSTOP    = 0.01 !stop time  
  DT    = 1e-5 !time step  
  DT_MAX                  = 1e-5 !maximum time step   
  DT_MIN                 = 1e-10 !minimum time step   
       
  ENERGY_EQ    = .FALSE.  !do not solve energy eq 
  SPECIES_EQ   = 2*.FALSE.    !do not solve gas species eq  
      
  MOMENTUM_X_EQ(1)   = .FALSE.  !do not solve momentum equation for solid phase  
  MOMENTUM_Y_EQ(1)   = .FALSE.    
  MOMENTUM_Z_EQ(1)   = .FALSE.   
       
  MOMENTUM_X_EQ(0)   = .f.  !do not solve momentum equation for gas phase  
  MOMENTUM_Y_EQ(0)   = .f.    
  MOMENTUM_Z_EQ(0)   = .f.    
  
      
      
      
      
! ----------------------- numerical solver section ------------------------------- 
      
  MAX_NIT    = 60  !max iteration count overall 
  TOL_RESID    = 0.001  !total residual tolerance 
  DISCRETIZE    = 9*2  !superbee discretization 
  DEF_COR    = .TRUE.    !use deferred correction method 
  LEQ_IT    = 9*200  !number of iterations all equations 
  LEQ_TOL    =9*1D-10  !tolerance all equations 
  LEQ_PC     = 9*'NONE'
         
      
                   
                                                                     
! ---------------------- Geometry Section ----------------------------------------
                                                                               
  COORDINATES    ='cartesian' !specify cartesian coordinates  
  XLENGTH     = 0.3       !length of domain in x direction 
  IMAX    = 12  !number of cells in x direction (i) 
  YLENGTH     = 0.3  !length of domain in y direction 
  JMAX    = 12  !number of cells in y direction (j) 
  ZLENGTH     = 0.1  !length of domain in z direction 
  KMAX   = 4  !number of cells in z direction (k) 
 
      
  GRAVITY    = 981  ! gravity 
        
      
                                                                                 
! ----------------------- Gas-phase Section -------------------------------------- 
       
  MU_g0    = 0.00018  !constant gas viscosity 
#  RO_g0   = 0  ! variable gas density 
  MW_avg    = 29  !MW of air
  P_REF    = 1010000  !reference pressure
      
       
! ----------------------- Solids-phase Section ---------------------------------- 
      
  DRAG_TYPE            = 'WEN_YU'  !not used since single phase  
  MMAX = 1
  RO_s         = 1.5
  D_p0         = 7.5D-3  !particle diameters  

  e         = 0.95  !not used, restitution coefficient (particle-particle)  
  e_w       = 0.95 !not used, restitution coefficient (walls, not used)  
  Phi      = 0  !not used, angle of internal friction  
  EP_star   = 0.4  !void fraction at minimum fluidization  
  C_f = 0.0
        
        
      
      
! ------------------------- Initial Conditions Section ---------------------------------         
      
  ! geometry    
  IC_X_w(1)             =  0 
  IC_X_e(1)             = 0.3
  IC_Y_s(1)             =  0
  IC_Y_n(1)             = 0.3
  IC_Z_b(1)             =  0
  IC_Z_t(1)             = 0.1
       
                                  !initial values     
  IC_EP_g(1)            = 0.7 !void fraction gas   
  IC_U_g(1)             =  0 !x-dir gas velocity   
  IC_V_g(1)            =  1 !y-dir gas velocity   
  IC_W_g(1)            =  0 !z-dir gas velocity   
  IC_P_g(1)		=  1010000
  IC_T_g(1)		=  300.0

      
  IC_U_s(1,1)   = 0 !solids x velocity   
  IC_V_s(1,1)   = 0 !solids y velocity   
  IC_W_s(1,1)   = 0 !solids z velocity   
 
        
  IC_Theta_m(1,1)   = 1 !solids phase granular temperature (not used)   
      
      

#  Inlet Boundary Conditions Section
#
#
      
! ---------------------- Boundary Conditions Section -----------------------------      
      
      
 ! DES INPUT SECTION     
                     
 PARTICLES  = 3 !total number of particles  
 
 DIMN  = 3    !number of dimensions in simulation
      
 KN  = 28000          ! Normal inter-particle collision spring constant   
 # default KT_FAC     
      
 MEW  = 0.3           ! Inter-particle friction coeffienct    
 KN_W  = 28000       ! Normal particle-wall collision spring constant   
 # default KT_W_FAC     
 MEW_W  = 0.3  ! Particle-wall friction coefficient  
      
 DES_EN_INPUT  = 0.95 !particle-particle rest coef   
 DES_EN_WALL_INPUT  = 0.95 !particle-wall rest coef   
      
 DES_NEIGHBOR_SEARCH  = 4 !Particle neighbor search method; 1=n-square; 2=quadtree; 3=octree; 4=grid based   
 MN  = 100 !Maximum number of neighbors allowed per particle   
 NEIGHBOR_SEARCH_N  = 2 !number of steps between neighbor searches   
 DTSOLID_FACTOR  = 0.1D0    
 
# particles_factor = 5
 
 NFACTOR = 0  ! DEM settling period performed nfactor times
      
      
 DES_INTERP_ON  = .F. !interpolate to find drag on particles   
 DISCRETE_ELEMENT  = .TRUE. !use discrete particle model for solids   
 WALLDTSPLIT  = .TRUE. !treat wall interaction as a particle-particle interaction   
 DES_CONTINUUM_COUPLED = .F. !couple gas and solid flow together   
 TSUJI_DRAG  = .FALSE. !use tsuji drag correlation   
 PRINT_DES_DATA  = .TRUE. !print DEM output  
 DES_RES_DT    = 0.00001
 DES_SPX_DT    = 0.00001   
##
# Input Data for cohesion Van Der Waals forces
##
 USE_COHESION  = .TRUE.
 SQUARE_WELL = .FALSE.  ! do not use square well potential
 MASTER_WELL_DEPTH = 1e-3
 MASTER_WALL_WELL_DEPTH=2e-3
 RADIUS_RATIO=1.01
 WALL_RADIUS_RATIO=1.01

 VAN_DER_WAALS = .TRUE.  ! use vdW short-range cohesive forces
 HAMAKER_CONSTANT = 1D-12
 WALL_HAMAKER_CONSTANT = 1D-12
 VDW_OUTER_CUTOFF = 0.002
 VDW_INNER_CUTOFF = 4d-8
 WALL_VDW_OUTER_CUTOFF = 0.002
 WALL_VDW_INNER_CUTOFF = 4d-8
 Asperities = 1.0D-4 ! use a 1 micron size asperities on spherical particles

# DES MASS OUTLET
# -----------------------------
# Outlet boundary on top
  DES_BC_X_w(1)          =   0.1
  DES_BC_X_e(1)          =   0.2
  DES_BC_Y_s(1)          =   0.0
  DES_BC_Y_n(1)          =   0.0
  DES_BC_Z_b(1)          =   0.0
  DES_BC_Z_t(1)          =   0.1
  DES_BC_TYPE(1)         =   'MO'
      
! ----------------------- Output Control -----------------------------------------      
!      
   OUT_DT  = 0.05 !write text file .OUT   every 0.05 seconds 
   RES_DT  = 1d-2 !write binary restart file every 0.01 seconds   
   NLOG    = 25 !write logfile .LOG every 25 timesteps   
   FULL_LOG  = .TRUE.  !display residuals on screen   
      
      
!SPX_DT values determine how often SPx files are written.        
   !sp1   sp2    sp3    sp4   sp5    sp6    sp7     sp8         sp9     spa     spb   
           !EP_g       P_g      U_g       U_s         ROP_s      T_g    X_g   
           !P_star    V_g        V_s        T_s      X_s       Theta     Scalar   
           !W_g       W_s   
SPX_DT  = 1d-2  0.01   0.01   0.01  0.01  100.  100.  0.01  1d-2  100.  100.     
       
      
      
!  The decomposition in I J and K directions for a Distributed Memory Parallel machine      
  NODESI = 1   NODESJ = 1   NODESK = 1
