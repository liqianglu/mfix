#
#  2d Spouted Bed with draft plates
#
# Author:  T. Li            Date: 23-Jan-2008

! 1. Run control
	Run_name	= 'test'
	Description	= 'glass bead'
	Units		= 'SI'
	Run_type	= 'new'
	Time		=  0.
	Tstop		=  1. 
	DT		= 1.0E-4
  DT_MAX          = 1.0e-3
 


  ENERGY_EQ             = .FALSE.                       !do not solve energy eq
  SPECIES_EQ            = .FALSE.    .FALSE.            !do not solve species eq
  MOMENTUM_X_EQ(1) = .FALSE.
  MOMENTUM_Y_EQ(1) = .FALSE.
  MOMENTUM_Z_EQ(1) = .FALSE.
  
   DETECT_STALL=.FALSE.
!   DEF_COR  =  .TRUE.
!   DT_FAC=1
!   UR_FAC(2) = 0.3

   NORM_g=0
   NORM_s=0
   MAX_NIT=500
   LEQ_IT=30
   TOL_RESID=1.0E-3

! 3. Geometry
                                                                               
  COORDINATES           = 'Cartesian' 
  XLENGTH               = 0.15                         !radius
  IMAX                  = 75                           !cells in i direction
  YLENGTH               = 0.7                         !height
  JMAX                  = 200                           !cells in j direction
  NO_K                  = .TRUE.                        !2D, no k direction
  DZ(1)                 = 0.00118
                                                                            
! Gas-phase Section                                                             
 
  MU_g0                 = 1.8E-5                        !constant gas viscosity
  RO_g0                 = 1.2                        !constant gas density

 
! Solids-phase Section                                                          
  
  RO_s                  = 2500                          !solids density
  D_p0                  = 0.00118                        !particle diameter     
  e                     = 0.95                         !restitution coefficient
  Phi                   = 30.0                           !angle of internal friction
  EP_star               = 0.385                          !void fraction at minimum
!  fluidization

  
! Initial Conditions Section                                                    
  
    ! 1. bed                                      
  IC_X_w(1)             =  0.0                         
  IC_X_e(1)             =  0.15                        
  IC_Y_s(1)             =  0.0
  IC_Y_n(1)             =  0.7 
                                                       
  IC_EP_g(1)            =  1.0                         
  IC_U_g(1)             =  0.0                         
  IC_V_g(1)             =  0.0                         
  IC_U_s(1,1)           =  0.0                         
  IC_V_s(1,1)           =  0.0                         
         
 
! 7. Boundary conditions
! Jet
  BC_X_w(1)             =  0.07                          
  BC_X_e(1)             =  0.08                          
  BC_Y_s(1)             =  0.0 
  BC_Y_n(1)             =  0.0

  BC_TYPE(1)            = 'MI'                          !specified mass inflow 

  BC_EP_g(1)            =  1.0 
  BC_U_g(1)             =  0.0 
  BC_V_g(1)             =  12.
  BC_P_g(1)             =  0.0                  

  BC_X_w(5)             =   0.0                        
  BC_X_e(5)             =   0.07                       
  BC_Y_s(5)             =  0.0
  BC_Y_n(5)             =  0.0

  BC_TYPE(5)            =  'NSW'      

  BC_X_w(6)             =   0.08                        
  BC_X_e(6)             =   0.15                        
  BC_Y_s(6)             =  0.0
  BC_Y_n(6)             =  0.0

  BC_TYPE(6)            =  'NSW'      
                                            
       ! 2. Exit
  BC_X_w(2)             =   0.0                         
  BC_X_e(2)             =   0.15                        
  BC_Y_s(2)             =  0.7
  BC_Y_n(2)             =  0.7

  BC_TYPE(2)            =  'PO'                         !specified pressure outflow
  BC_P_g(2)             =  0.0       
			  
       ! 3. Left wall
  BC_X_w(3)             =   0.0                        
  BC_X_e(3)             =   0.0                        
  BC_Y_s(3)             =  0.0
  BC_Y_n(3)             =  0.7

  BC_TYPE(3)            =  'NSW'                         
       
       ! 4. Right wall
  BC_X_w(4)             =   0.15                         
  BC_X_e(4)             =   0.15                         
  BC_Y_s(4)             =  0.0
  BC_Y_n(4)             =  0.7

  BC_TYPE(4)            =  'NSW'                          

                        !  Define Obstacles
			 !  1        2        3        4         5
	BC_X_w(20)	= 0     0.002	0.004	0.006	0.008
	BC_X_e(20)	= 0.002	0.004   0.006	0.008	0.01
	BC_Y_s(20)	= 5*0.0
	BC_Y_n(20)	=0.1155 0.112	0.1085	0.105	0.1015
	BC_TYPE(20)	=5*'NSW'

			 ! 6        7        8        9         10
	BC_X_w(25)	= 0.01	0.012	0.014	0.016	0.018
	BC_X_e(25)	= 0.012	0.014	0.016	0.018	0.02
	BC_Y_s(25)	= 5*0.0
	BC_Y_n(25)	= 0.098	0.0945	0.091	0.0875	0.084
	BC_TYPE(25)	=5*'NSW'

			     ! 11 	12   	13 		14 		15 
	BC_X_w(30)	= 0.02	0.022	0.024	0.026	0.028
	BC_X_e(30)	= 0.022	0.024	0.026	0.028	0.03 
	BC_Y_s(30)	=5*0.0
	BC_Y_n(30)	=0.0805	0.077	0.0735	0.07	0.0665
	BC_TYPE(30)	=5*'NSW'
	
			     ! 16 	17   	18 		19 		20 
	BC_X_w(35)	= 0.03	0.032	0.034	0.036	0.038
	BC_X_e(35)	= 0.032	0.034	0.036	0.038	0.04 
	BC_Y_s(35)	=5*0.0
	BC_Y_n(35)	=0.063	0.0595	0.056	0.0525	0.049
	BC_TYPE(35)	=5*'NSW'

			     ! 21 	22   	23 		24 		25 
	BC_X_w(40)	= 0.04	0.042	0.044	0.046	0.048
	BC_X_e(40)	= 0.042	0.044	0.046	0.048	0.05 
	BC_Y_s(40)	=5*0.0
	BC_Y_n(40)	=0.0455	0.042	0.0385	0.035	0.0315
	BC_TYPE(40)	=5*'NSW'

			     ! 26 	27   	28 		29 		30 
	BC_X_w(45)	= 0.05	0.052	0.054	0.056	0.058
	BC_X_e(45)	= 0.052	0.054	0.056	0.058	0.06 
	BC_Y_s(45)	=5*0.0
	BC_Y_n(45)	=0.028	0.0245	0.021	0.0175	0.014
	BC_TYPE(45)	=5*'NSW'
	
			     ! 31 	32   	33 		
	BC_X_w(50)	= 0.06	0.062	0.064	
	BC_X_e(50)	= 0.062	0.064	0.066	
	BC_Y_s(50)	=3*0.0
	BC_Y_n(50)	=0.0105	0.007	0.0035	
	BC_TYPE(50)	=3*'NSW'

	! 53   54      55
	BC_X_w(53)	= 0.084	0.086	0.088	
	BC_X_e(53)	= 0.086	0.088	0.09	
	BC_Y_s(53)	=3*0.0
	BC_Y_n(53)	=0.0035	0.007	0.0105	
	BC_TYPE(53)	=3*'NSW'

			     ! 56 	57   	58 		59 		60 
	BC_X_w(56)	= 0.09	0.092	0.094	0.096	0.098
	BC_X_e(56)	= 0.092	0.094	0.096	0.098	0.1 
	BC_Y_s(56)	=5*0.0
	BC_Y_n(56)	=0.014	0.0175	0.021	0.0245	0.028
	BC_TYPE(56)	=5*'NSW'

			     ! 61 	
	BC_X_w(61)	= 0.1	0.102	0.104	0.106	0.108
	BC_X_e(61)	= 0.102	0.104	0.106	0.108	0.11 
	BC_Y_s(61)	=5*0.0
	BC_Y_n(61)	=0.0315	0.035	0.0385	0.042	0.0455
	BC_TYPE(61)	=5*'NSW'
	
			     ! 66 
	BC_X_w(66)	= 0.11	0.112	0.114	0.116	0.118
	BC_X_e(66)	= 0.112	0.114	0.116	0.118	0.12 
	BC_Y_s(66)	=5*0.0
	BC_Y_n(66)	=0.049	0.0525	0.056	0.0595	0.063
	BC_TYPE(66)	=5*'NSW'	
		
			     ! 71 	
	BC_X_w(71)	= 0.12	0.122	0.124	0.126	0.128
	BC_X_e(71)	= 0.122	0.124	0.126	0.128	0.13 
	BC_Y_s(71)	=5*0.0
	BC_Y_n(71)	=0.0665	0.07	0.0735	0.077	0.0805
	BC_TYPE(71)	=5*'NSW'

			     ! 76 
	BC_X_w(76)	= 0.13	0.132	0.134	0.136	0.138
	BC_X_e(76)	= 0.132	0.134	0.136	0.138	0.14 
	BC_Y_s(76)	=5*0.0
	BC_Y_n(76)	=0.084	0.0875	0.091	0.0945	0.098
	BC_TYPE(76)	=5*'NSW'	
		
			     ! 81 	
	BC_X_w(81)	= 0.14	0.142	0.144	0.146	0.148
	BC_X_e(81)	= 0.142	0.144	0.146	0.148	0.15 
	BC_Y_s(81)	=5*0.0
	BC_Y_n(81)	=0.1015	0.105	0.1085	0.112	0.1155
	BC_TYPE(81)	=5*'NSW'	

	BC_X_w(86)	= 0.066	0.08
	BC_X_e(86)	= 0.070	0.084
	BC_Y_s(86)	=2*0.0
	BC_Y_n(86)	=2*0.0
	BC_TYPE(86)	=2*'NSW'	
	
!	draft plates
	IS_X_w		=  0.06		0.09
	IS_X_e		=  0.06		0.09
	IS_Y_s		=  0.0735    0.0735
	IS_Y_n		=  0.343    0.343    

   IS_TYPE		= 'IP' 'IP'

!
! DES INPUT
!               
PARTICLES =5000    ! Number of particles
MN = 14             ! Maximum number of neighbors allowed per particle
KN = 5289         ! Normal inter-particle collision spring constant
KT = 5289         ! Tangential     "        "         "       "
ETA_DES_N =0.0083      ! Normal inter-particle damping coefficient
ETA_DES_T =0.0083    ! Tangential  "          "        "
MEW = 0.46           ! Inter-particle friction coeffienct
KN_W = 10580      ! Normal particle-wall collision spring constant
KT_W = 10580      ! Tangential   "           "       "      "
ETA_N_W = 0.0167        ! Normal particle-wall damping coefficient
ETA_T_W = 0.0167        ! Tangential    "         "        "
MEW_W = 0.32         ! Particle-wall friction coefficient
DES_NEIGHBOR_SEARCH = 2 ! Particle neighbor search method; 1=n-square; 2=quadtree; 3=octree
NEIGHBOR_SEARCH_N = 1
DTSOLID_FACTOR = 0.1d0
PRINT_DES_DATA =.T.
P_TIME = 0.1

!  DES Logicals
DISCRETE_ELEMENT = .TRUE. 
WALLDTSPLIT = .TRUE.
DES_CONTINUUM_COUPLED = .t.
TSUJI_DRAG = .TRUE.
DES_INTERP_ON=.f.
NON_RECT_BC = .TRUE.

! End DES Input


		
!  Output Control                                                               
!                  
  OUT_DT                = 2.                           !write text file BUB02.OUT
                                                       !  every 10 s
  RES_DT                = 0.005                          !write binary restart file
                                                        !  BUB02.RES every 0.01 s
  NLOG                  = 50                            !write logfile BUB02.LOG 
                                                        !every 25 time steps
  FULL_LOG              = .t.                        !display residuals on screen


!SPX_DT values determine how often SPx files are written.  Here BUB02.SP1, which
!contains void fraction (EP_g), is written every 0.01 s, BUB02.SP2, which contains
! gas and solids pressure (P_g, P_star), is written every 0.1 s, and so forth.
!
        ! EP_g P_g       U_g  U_s  ROP_s     T_g  X_g
        !      P_star    V_g  V_s            T_s  X_s     Theta   Scalar 
        !                W_g  W_s
  SPX_DT = 0.01 0.01 0.01  0.01  100.      100. 100.   100.0     100.        
                                                                                

!  Sweep Direction

