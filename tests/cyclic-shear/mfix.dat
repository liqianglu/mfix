! A fully 2D periodic case with dv/dx shear 
! Author: S. Pannala

!*********************************************************************
! Run Control
!*********************************************************************
  RUN_NAME = 'RISER'
  DESCRIPTION = 'Gas-Particle Flow in a 2D periodic cell'
  RUN_TYPE = 'new'

  UNITS = 'cgs'

  TIME  = 0.0
  TSTOP = 2.0
  DT = 1E-3 
  DT_MAX = 0.4E-4

!  DT_FAC=1.0      ! factor for adjusting the time step [0.9]
                  ! value of 1 holds the time step constant

  ENERGY_EQ = .FALSE.
  SPECIES_EQ = .FALSE.    .FALSE.
  MOMENTUM_X_EQ  =  .TRUE.   .TRUE.
  MOMENTUM_Y_EQ  =  .TRUE.   .TRUE.
  MOMENTUM_Z_EQ  = .FALSE.   .FALSE.

! solve a granular energy transport equation(s) as opposed to an
! algebraic equation?   [.FALSE.]
  GRANULAR_ENERGY = .TRUE.

! the kinetic theory model used to describe the solids phase(s)
  KT_TYPE = 'LUN_1984'     

! use the schaeffer type frictional (plastic) model for the solids
! phase(s)?  [.TRUE.]
  SCHAEFFER = .TRUE.

! use a frictional model for solids pressure/viscosity? this cannot
! be invoked simultaneously with schaeffer  [.FALSE.]
  FRICTION= .FALSE.

! call specific user routines?  [.FALSE.]
  CALL_USR=.FALSE.
        

!*********************************************************************
! Numerical Parameters
!*********************************************************************
  MAX_NIT = 100
  TOL_RESID = 1E-4

! Discretization scheme
!                [0] : First-order upwinding
!                 1  : First-order upwinding (using down-wind factors)
!                 2  : Superbee (recommended method)
!                3-8 : see readme for details
  DISCRETIZE  = 9*2 

! factor to normalize gas pressure/solids correction equation(s) 
! residual 
!  [undefined] : normalization uses residual from first iteration 
!      0       : normalization based on dominate term in continuity eqn
!  [defined]   : normalized by value provided
  NORM_s = 1E-1
#  NORM_g = 1e-1

! reduce time step if residuals sum does not decrease?  
#  DETECT_STALL = .FALSE.

! Number of iterations in the linear equation solver
!      [LEQ_IT(1,2)=20]
!      [LEQ_IT(3-5)=5]
!      [LEQ_IT(6-9)=15]
  LEQ_IT(1) = 200
  LEQ_IT(2) = 200

! Under relaxation factors 
!      [UR_FAC(1,6,9)=0.8]
!      [UR_FAC(2,3,4,5,8)=0.5]
!      [UR_FAC(7)=1]
  UR_FAC(8) = 1.0
  UR_FAC(9) = 1.0

! Use deferred correction method for implementing higher order
! discretization.  Otherwise use down-wind factor method (default)
  DEF_COR = .TRUE.


!*********************************************************************
! Geometry and Discretization
!*********************************************************************
  COORDINATES = 'Cartesian'

  XLENGTH  =   1.0    IMAX = 16
  YLENGTH  =   4.0    JMAX = 64

  NO_K     = .TRUE.

!*********************************************************************
! Gas Phase
!*********************************************************************
  MU_g0 = 1.8E-4
! the molecular weight or density must be specified (or species names).
! if density is specified then the molecular weight will be ignored.
! specifying molecular weight allows for compressibility but requires
! setting the pressure and temperature in IC and BC regions
  RO_g0 = 1.3E-3
!  MW_avg  = 29.


!*********************************************************************
! Solid Phase
!*********************************************************************
  MMAX  =  1     ! number of 'solids' phases [1]
  SOLIDS_MODEL(1) = 'TFM'     ! set the model type for the indicated
                              ! solids
  RO_s0 = 1.5     ! material particle density
  D_p0 = 0.0075     ! particle diameter (75 microns)
  CLOSE_PACKED = .TRUE.      ! solids phase forms a packed bed with
                             ! indicated void fraction ep_star

  e       = 0.9     ! coefficient of restitution p-p
  Phi     = 28.5     ! angle of internal friction (in degrees)
  Phi_w   = 18.0     ! angle of internal friction at walls (in degrees)
  EP_star = 0.15     ! packed bed void fraction 
                     ! (system may become very packed)

!*********************************************************************
! Initial Conditions
!********************************************************************* 
! geometry --------------------
  IC_X_w           =   0.0     
  IC_X_e           =   1.0  
  IC_Y_s           =   0.0   
  IC_Y_n           =   4.0  
 
  IC_EP_g          =   0.90     ! dilute solids system 
                                ! solids volume fraction (eps=0.1)
 
  IC_U_g           =   0.0     
  IC_V_g           =   0.0  
  IC_T_g           = 300.0 
  IC_P_g           =   0.0    

  IC_U_s           =   0.0  
  IC_V_s           =   0.0           
  IC_Theta_m       =   1.0     ! specifies initial granular temperature
                               ! since LUN_1984 is used units are cm/s^2

  IC_P_star        =   0.0     ! specifies initial 'plastic' pressure 
                               ! of solids

!*********************************************************************
! Boundary Conditions
!*********************************************************************
! A fully 2D periodic system.  The pressure drop across ylength is
! imposed in y-direction.

! make y direction cyclic w/ specified pressure drop
#   CYCLIC_Y   = .TRUE.
  CYCLIC_Y_PD = .TRUE.    
! the fluid pressure drop across ylength
  DELP_Y =592.9885122     ! 299.0439851   (Bayre)

! make x direction cyclic w/o pressure drop
  CYCLIC_X    = .TRUE.   ! make x-direction cyclic

! impose a mean shear on the flow field as linear function of the
! x-coordinate.  Requires cyclic_x be set to true.
  SHEAR=.TRUE.

! the mean y velocity component at the eastern boundary. the mean
! velocity at the western boundary is set as -V_sh.  This gives the
! shear rate as dv/dx (2*V_sh/XLENGTH)
  V_sh=5d0



!*********************************************************************
!  Output Control
!*********************************************************************

  RES_DT     =  0.005    ! Interval to update restart (.RES) file 
  OUT_DT     =  1.0      ! Interval to update standard output (.OUT) file 

  SPX_DT(1)  =  2.0E-2   ! Void fraction (EP_g)
  SPX_DT(2)  =  0.02     ! Gas and solids pressure (P_g, P_star)
  SPX_DT(3)  =  0.02     ! Gas velocity (U_g, V_g, W_g)
  SPX_DT(4)  =  0.02     ! Solids velocity (U_s, V_s, W_s)
  SPX_DT(5)  =  0.02     ! Solids density (ROP_s)
  SPX_DT(6)  =  1.0E+2   ! Gas and solids temp. (T_g, T_s1, T_s2)
  SPX_DT(7)  =  1.0E+2   ! Gas and solids mass fractions (X_g, X_s)
  SPX_DT(8)  =  0.02     ! Granular Temperature (G)
  SPX_DT(9)  =  1.0E+2   ! User defined scalars

  FULL_LOG = .TRUE.      ! Display residuals on screen and messages on
                         ! convergence
! Specify residuals to be printed as 4-character strings.
! The first character specifies the field variable.
!     P: pressure    R: density     U: u-velocity,     V: v-velocity
!     W: w-velocity  T: temperture  G: granular temp.
!     X: species mass fraction
! The second nnumber specifies the phase.
!     0: Gas
! The last two numbers specify the species index.
  RESID_STRING  = 'P0' 'P1' 'U0' 'U1' 'V0' 'V1' 'G1'


!*********************************************************************
! Parallelization Controls
!*********************************************************************
! Number of grid blocks in X/Y/Z directions (i,j,k) for a distributed
! memory parallel simulation   [1]
  NODESI = 1   NODESJ = 1   NODESK = 1

