!  Fluidized Bed Simulation with Particle Segregation
!                                                                               
!  bub01 - fluidized bed with a central jet with particle segregation
! 
! ****************** Reference ************************************
! Goldschmidt, M.J.V., Kuipers, J.A.M., and van Swaiij, W.P.M., (2001),
! Segregation in Dense Gas-Fluidised Beds: Validation of Multi-Fluid
! Continuum Model with Non-intrusive Digital Image Analysis
! Measurements, 10th Engineering Foundation Conference on Fluidization,
! Beijing, China, May 20-25, pp.795-802
! **********************************************************************

                           
! Run-control section                                                                                                   
  RUN_NAME              = 'RONG'             
  DESCRIPTION           = 'particle segregation'
  RUN_TYPE              = 'new'             
  UNITS                 = 'cgs'
  TIME                  = 0.0                           !start time
  TSTOP                 = 1.0E-2
  DT                    = 1.0E-4                        !time step
!  DT_FAC         = 1.
!  DT_MAX=       1.0e-4
  DETECT_STALL = .FALSE
  CLOSE_PACKED  = .TRUE.  .TRUE.
    ENERGY_EQ           = .FALSE.                       !do not 
  SPECIES_EQ            = .FALSE.    .FALSE.    .FALSE. !do not s
        DISCRETIZE  =   7*2
                                                                               
! Geometry Section                                                              
                                                                               
  COORDINATES   = 'cartesian' 
  XLENGTH       =   15                          !radius
  IMAX          =   15                          !cells in i direction
  YLENGTH       = 30.0                          !height
  JMAX          = 30                            !cells in j direction
  NO_K          = .TRUE.                        !2D, no k direction
  C(10)         = 0.3
                                                                               
! Gas-phase Section                                                             
 
  MU_g0                 = 1.8E-4                !constant gas viscosity
  RO_g0                 = 1.20e-3               !constant gas density

 
! Solids-phase Section 

  MMAX                  = 2
  RO_s                  = 2.524d0  2.524d0      !solids density
  D_p                   = 0.15d0  0.25d0        !particle diameter     
  e                     = 0.97d0                !restitution coefficient
  C_f                   = 0.1d0
  Phi                   = 55.d0                 !angle of internal friction
  EP_star               = 0.4d0                 !void fraction at minimum
  C(11)                 = 0.4                   !0.4
!                                               !  fluidization  
! Initial Conditions Section                                                    
! 
    ! 1. bed           
  IC_X_w(1)             =  0.0                  !lower half of the domain
  IC_X_e(1)             =  15.0                 ! 0 < x < 7, 0 < y < 50
  IC_Y_s(1)             =  0.0
  IC_Y_n(1)             =  15.0                 !initial values in the region
  IC_EP_g(1)            =  0.41d0               !void fraction
  IC_ROP_s(1,1)         =  0.74458              !0.69685!0.7602d0
  IC_ROP_s(1,2)         =  0.74458d0            !0.69685!0.7602d0 
  
  IC_U_g(1)             =  0.0                  !radial gas velocity
  IC_V_g(1)             =  0.0                  !axial gas velocity
  IC_U_s(1,1)           =  0.0                  !radial solids velocity 
  IC_V_s(1,1)           =  0.0                  !axial solids velocity
  IC_U_s(1,2)           =  0.0                  !radial solids velocity
  IC_V_s(1,2)           =  0.0 

    !  2. Freeboard     
  IC_X_w(2)             =  0.0 
  IC_X_e(2)             =  15.0
  IC_Y_s(2)             =  15.0
  IC_Y_n(2)             =  30.0
  IC_EP_g(2)            =  1.0 
  IC_ROP_s(2,1)         =  0.0
  IC_ROP_s(2,2)         =  0.0 
  IC_U_g(2)             =  0.0
  IC_V_g(2)             =  0.0
  IC_U_s(2,1)           =  0.0
  IC_V_s(2,1)           =  0.0 
  IC_U_s(2,2)           =  0.0
  IC_V_s(2,2)           =  0.0  
!  Boundary Conditions Section   
  
       ! 1. Central jet     
  BC_X_w(1)             =  0.0                  !central jet
  BC_X_e(1)             =  10.0                 ! 0 < x < 1, y = 0
  BC_Y_s(1)             =  0.0 
  BC_Y_n(1)             =  0.0

  BC_TYPE(1)            = 'MI'                  !specified mass inflow 

  BC_EP_g(1)            =  1.0 
  BC_U_g(1)             =  0.0 
  BC_V_g(1)             =  110.0
  BC_P_g(1)             =  0.0

       ! 2. Distributor flow    
  BC_X_w(2)             =  10.0         !gas distributor plate
  BC_X_e(2)             =  15.0         ! 1 < x < 7, y = 0
  BC_Y_s(2)             =  0.0 
  BC_Y_n(2)             =  0.0

  BC_TYPE(2)            = 'MI'          !specified mass inflow 

  BC_EP_g(2)            =  1.0 
  BC_U_g(2)             =  0.0 
  BC_V_g(2)             =  110.0! 110.0 
  BC_P_g(2)             =  0.0  
             
       ! 3. Exit
  BC_X_w(3)             = 0.0           !top exit
  BC_X_e(3)             = 15.0          ! 0 < x < 7, y = 100
  BC_Y_s(3)             = 30.0
  BC_Y_n(3)             = 30.0 
  BC_TYPE(3)            = 'PO'          !specified pressure outflow
  BC_P_g(3)             = 0.0       
!   
!  Output Control  
!   
  OUT_DT                = 1.            !write text file BUB01.OUT
  RES_DT                = 0.01          !write binary restart file
!  BUB01.RES every 0.01 s
  NLOG                  = 25            !write logfile BUB01.LOG 
!every 25 time steps
  FULL_LOG              = .TRUE.        !display residuals on screen

!SPX_DT values determine how often SPx files are written.  Here BUB01.SP1, which
!contains void fraction (EP_g), is written every 0.01 s, 
! gas and solids pressure (P_g, P_star), is written every 
!
        ! EP_g P_g       U_g  U_s  ROP_s     T_g  X_g
        !      P_star    V_g  V_s            T_s  X_s     Theta   Scalar 
        !                W_g  W_s
  SPX_DT = 0.1 0.1      0.1  0.1  0.1      100. 100.   100.0     100. 
  RESID_STRING  = 'P0' 'P1' 'U0' 'R2' 'V0' 'V1' 'V2'       
!  The decomposition in I, J, and K directions for a Distributed Memory Parallel
  
  NODESI = 1   NODESJ = 1   NODESK = 1

!  Sweep Direction

LEQ_SWEEP(1) = 'ISIS' 
LEQ_SWEEP(2) = 'ISIS'  
LEQ_SWEEP(3) = 'ISIS' 
LEQ_SWEEP(4) = 'ISIS'  
LEQ_SWEEP(5) = 'ISIS'  
LEQ_SWEEP(6) = 'ISIS'  
LEQ_SWEEP(7) = 'ISIS' 
LEQ_SWEEP(8) = 'ISIS'  
LEQ_SWEEP(9) = 'ISIS'
