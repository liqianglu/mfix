#                                                                               
# Pure DEM 
#            
# Description: One particle freely falling under gravity and 
# colliding with a wall.  Based on the work of Chen et al.,
# International Journal of Geomechanics, 2007
 

# Run-control section
  RUN_NAME = 'DES_PFF' 
  DESCRIPTION = 'particle free fall'
  RUN_TYPE = 'new'
  UNITS = 'cgs'
  TIME  =0.0  TSTOP = 0.5 
  DT = 1.0e-4
  DT_MAX = 2E-4
  ENERGY_EQ = .FALSE.
  SPECIES_EQ = .FALSE.    .FALSE. !.FALSE.    .FALSE.
  MOMENTUM_X_EQ = .FALSE.  .FALSE.
  MOMENTUM_Y_EQ = .FALSE.  .FALSE.
  MOMENTUM_Z_EQ = .FALSE.  .FALSE.

  CALL_USR = .TRUE.

# Numeric Section
  DISCRETIZE = 9*2
  MAX_NIT = 500


# Geometry Section
  COORDINATES = 'Cartesian'
  XLENGTH  = 120    IMAX = 6
  YLENGTH  = 120    JMAX = 6
  ZLENGTH  = 120    KMAX = 6
!  NO_K     = .TRUE.


# Gas-phase Section
  RO_g0 = 0.0
  MU_g0 = 2E-1


# Solids-phase Section
! when using DEM the variable MMAX is used, when using DEM with 
! gener_part_config then RO_S(M) and D_p0(M) are also used (they
! are otherwise read in from particle_input.dat).  whether used
! or not, the following quantities must be defined to bypass the
! checks made in MFIX
  MMAX    = 2
  RO_s    = 2.600000    2.600001
  D_p0    = 20.00000   20.000000

  e       = 0.9
  Phi     = 0.0
  EP_star = 0.43               


# Initial Conditions Section
       !              
  IC_X_w(1)         =   0.0
  IC_X_e(1)         = 120.0
  IC_Y_s(1)         =   0.0
  IC_Y_n(1)         = 120.0
  IC_Z_b(1)         =   0.0
  IC_Z_t(1)         = 120.0 
  IC_EP_g(1)        =   1.0

  IC_U_g(1)         =   0.0
  IC_V_g(1)         =   1.0
  IC_W_g(1)         =   0.0
  IC_U_s(1,1)       =   0.0  
  IC_V_s(1,1)       =   0.0
  IC_W_s(1,1)       =   0.0  
  IC_P_g(1)         =   1.013E6
  IC_T_g(1)         = 273. 


# Output Control
  OUT_DT                = 10.           !write text file R.OUT (every xx s)
  RES_DT                = 0.01          !write binary restart file (R.RES every xx s) 
  NLOG                  = 100           !write logfile R.LOG (every xx time steps)
  FULL_LOG              = .TRUE.        !display residuals on screen

!  SPX_DT values determine how often SPx files are written.  
!  gas and solids pressure (P_g, P_star), is written every 0.1 s, and so forth.
!  1 = EP_g,   2= P_g & P_star,  3 = U_g, V_g, & W_g,  4 = U_s, V_s, & W_s
!  5 = ROP_s,  6 = T_g, T_sM,    7 = X_g, X_s,         8 = ThetaM
!  9 = scalar, 10(A) = rrate,    11(B)=k_epsilon

  SPX_DT    = 0.001 
  SPX_DT(2) =  .1      .1     .1     .1     .1     100.    100.  100.
  
  RESID_STRING = 'P0' 'P1' 'U0' 'U1' 'V0' 'V1' 'G1'  ! display residuals


# DMP control
  NODESI = 2   NODESJ = 2   NODESK = 2


# DES
  DISCRETE_ELEMENT = .TRUE. 
  !DES_INTERP_ON = .TRUE.       ! false by default
  DES_CONTINUUM_COUPLED = .F.   ! false by default
  WALLDTSPLIT = .TRUE.          ! false by default (must be true for DEM)
  DIMN = 3
  GRAVITY=980.0d0

  DES_NEIGHBOR_SEARCH = 4   ! Particle neighbor search method:
                            ! 1=n-square; 2=quadtree; 3=octree; 4=gridbased
  MN = 2                    ! Maximum number of neighbors allowed per particle
  NEIGHBOR_SEARCH_N = 1     ! ~Maximum number of steps through DEM loop before
                            ! neighbor search is performed (default=25)

  PARTICLES = 4

  KN       = 5.0D7       ! Normal inter-particle collision spring constant
  KT_FAC   = @(2/7)      ! Tangential spring factor = KT/KN

  KN_W     = 5.0D7       ! Normal particle-wall collision spring constant
  KT_W_FAC = @(2/7)      ! Tangential spring factor = KT_W/KN_W

  MEW      = 0.0         ! Inter-particle friction coeffienct
  MEW_W    = 0.0         ! Particle-wall friction coefficient

! particle-particle rest coef
  DES_EN_INPUT(1)   = 0.9   0.9     ! e11 e12
  DES_EN_INPUT(3)   = 0.9         ! e22
  DES_ETAT_FAC      = @(1/2)  ! damping coefficient factor = ETAT/ETAN

! particle-wall rest coef
  DES_EN_WALL_INPUT = 0.9   1.0     ! e1w e2w
  DES_ETAT_W_FAC    = @(1/2)  ! damping coefficient factor = ETAT_W/ETAN_W


  PRINT_DES_DATA = .TRUE.
  DES_SPX_DT = 0.20
  DES_RES_DT = 1.0
