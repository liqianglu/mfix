#
# Pure DEM 
#
# Description: Two stacked particles compressed between two 
# boundaries.  Based on the work of Chen et al., International
# Journal of Geomechanics, 2007


# Run-control section
# -----------------------------
  RUN_NAME = 'DES_2SP' 
  DESCRIPTION = 'Two stacked particles'
  RUN_TYPE = 'new'
  UNITS = 'cgs'
  TIME  =0.0 
  TSTOP = 0.001
  DT = 1.0e-4
  DT_MAX = 2E-4

  ENERGY_EQ = .FALSE.
  SPECIES_EQ = .FALSE.    .FALSE.  .FALSE.

  MOMENTUM_X_EQ = .FALSE. .FALSE.  .FALSE.
  MOMENTUM_Y_EQ = .FALSE. .FALSE.  .FALSE.
  MOMENTUM_Z_EQ = .FALSE. .FALSE.  .FALSE.

  GRAVITY = 980.665D0

  CALL_USR = .T.

# Geometry Section
# -----------------------------
  COORDINATES = 'Cartesian'
  XLENGTH  = 1     IMAX = 10
  YLENGTH  = 0.18   JMAX = 1
  NO_K     = .TRUE.


# Numeric
# -----------------------------
  MAX_NIT = 500
  DISCRETIZE = 9*0


# Gas-phase Section
# -----------------------------
  RO_g0 = 0.0
  MU_g0 = 2E-1
  MW_avg = 29.


# Solids-phase Section
# -----------------------------
! when using DEM the variable MMAX is used, when using DEM with 
! gener_part_config then RO_S(M) and D_p0(M) are also used (they
! are otherwise read in from particle_input.dat).  whether used
! or not, the following quantities must be defined to bypass the
! checks made in MFIX
  MMAX     = 2

  SOLIDS_MODEL = 'DEM'   'DEM'
  RO_s0 =         20.0   10.0
  D_p0 =          0.1     0.1

  e        = 0.8
  Phi     = 0.0
  EP_star = 0.40            
  C_f = 0.0


# Initial Conditions Section
# -----------------------------
       !              
  IC_X_w(1)           =  0.0
  IC_X_e(1)           =  1.0
  IC_Y_s(1)           =  0.0
  IC_Y_n(1)           =  0.18

  IC_EP_g(1)          =  1.0
   
  IC_U_g(1)           =  0.0
  IC_V_g(1)           =  0.0
  IC_W_g(1)           =  0.0
  IC_U_s(1,1)         =  0.0  
  IC_V_s(1,1)         =  0.0
  IC_W_s(1,1)         =  0.0  
  IC_U_s(1,2)         =  0.0  
  IC_V_s(1,2)         =  0.0
  IC_W_s(1,2)         =  0.0  

  IC_P_g(1)           =  0.0
  IC_T_g(1)           =  273. 

     
#  Boundary Conditions Section
# -----------------------------
! None. Use default walls.


#  DES
# -----------------------------

! Number of particles.
  PARTICLES = 2 

! Particle neighbor search method [1]
!  1=n-square; 2=quadtree; 3=octree; 4=gridbased
  DES_NEIGHBOR_SEARCH = 1 

! ~Maximum number of steps through DEM loop before 
!  neighbor search is performed [25]
  NEIGHBOR_SEARCH_N = 1  

  PRINT_DES_DATA = .TRUE.     ! write *.vtp file
  DES_SPX_DT = 0.0005         ! interval to write *.vtp files in pure DEM simulation
  DES_RES_DT = 0.0010         ! interval to write des.res and .res files in pure DEM simulation

  KN       = 1.0D6       ! Normal inter-particle collision spring constant
  KT_FAC   = 1.d0        ! Tangential spring factor = KT/KN

  KN_W     = 1.0D6       ! Normal particle-wall collision spring constant
  KT_W_FAC = 1.d0        ! Tangential spring factor = KT_W/KN_W

  MEW      = 0.0         ! Inter-particle friction coeffienct
  MEW_W    = 0.0         ! Particle-wall friction coefficient

  DES_EN_INPUT      = 0.8  0.8  0.8    ! particle-particle rest coef
  DES_ETAT_FAC      = 1.0     ! damping coefficient factor = ETAT/ETAN

  DES_EN_WALL_INPUT = 0.8  0.8  0.8    ! particle-wall rest coef
  DES_ETAT_W_FAC    = 1.0     ! damping coefficient factor = ETAT_W/ETAN_W


#  Output Control
# -----------------------------
  RES_DT = 0.01    ! interval at which restart (.RES) file is updated
  NLOG = 25        ! interval in no. of time steps at which (.LOG) file is written

! Interval at which .SPX files are written 
  SPX_DT(1)       = 0.001     ! Void fraction (EP_g)
  SPX_DT(2)       = 0.001     ! Gas and solids pressure (P_g, P_star)
  SPX_DT(3)       = 0.01      ! Gas velocity (U_g, V_g, W_g)
  SPX_DT(4)       = 0.01      ! Solids velocity (U_s, V_s, W_s)
  SPX_DT(5)       = 100.0     ! Solids density (ROP_s)
  SPX_DT(6)       = 100.0     ! Gas and solids temp. (T_g, T_s1, T_s2)
  SPX_DT(7)       = 100.0     ! Gas and solids mass fractions (X_g, X_s)
  SPX_DT(8)       = 0.01      ! Granular Temperature (G)
  SPX_DT(9)       = 100.0     ! User defined scalars

  FULL_LOG = .TRUE.           ! display residuals on screen
  RESID_STRING = 'P0' 'P1' 'V1'


# DMP control
# -----------------------------
  NODESI = 1 
  NODESJ = 1
  NODESK = 1

