!######################################################################!
!  Author: J.Musser                                 Date:   2012-11-16 !
!                                                                      !
!  Purpose: This simulation reflects 'Run 03' from Kulic and Rhodes.   !
!  A single droplet is suspended in a humidified air/water vapor       !
!  stream.                                                             !
!                                                                      !
!  The droplet temperature is recorded for comparison with reported    !
!  experimental data [1,2].                                            !
!                                                                      !
!  References:                                                         !
!``````````````````````````````````````````````````````````````````````!
!  1. E.Kulic and E.Rhodes. (1977) "Direct contact condensation from   !
!     Air-Steam mixtures on a single droplet," The Canadian Journal of !
!     Chemical Engineering, Vol. 55, 131-137.                          !
!                                                                      !
!  2.  E. Kulic (1976). An experimental and theoretical study of simul-!
!     taneous heat and mass transfer applided to steam dousing.        !
!     University of Waterloo, Ph.D. Thesis.                            !
!                                                                      !
!  3. A.F. Mills. 1999. Basic Heat and Mass Transfer. Prentice Hall,   !
!     USA.                                                             !
!                                                                      !
!######################################################################!

  RUN_NAME  = 'KR_03'
  DESCRIPTION  = 'Condensation: Kulic and Rhodes, Run 03'

#_______________________________________________________________
# RUN CONTROL SECTION

  UNITS    = 'cgs'
  RUN_TYPE = 'new'
  TIME     = 0.0
  TSTOP    = 4.05
  DT       = 5.0E-3  DT_FAC   = 1.0

  GRAVITY  = 980.7

  ENERGY_EQ  = .T.
  SPECIES_EQ = .T.  .F.

  MOMENTUM_X_EQ  = .T.   .F.
  MOMENTUM_Y_EQ  = .F.   .F.
  MOMENTUM_Z_EQ  = .F.   .F.

  CALL_USR = .T.

#_______________________________________________________________
# NUMERICAL SECTION

  DEF_COR  =  .F.
  NORM_G  = 2.0


#_______________________________________________________________
# GEOMETRY SECTION 

  COORDINATES = 'cartesian'

  XLENGTH  = 1.0   IMAX = 1
  ZLENGTH  = 1.0   KMAX = 1
  YLENGTH  = 1.0   JMAX = 1


#_______________________________________________________________
# MATERIAL SECTION

# GAS SECTION
#------------------------------------------//
  NMAX_g = 2
  SPECIES_g(1) = 'AIR'   SPECIES_ALIAS_g(1) = 'AIR'
  SPECIES_g(2) = 'H2O'   SPECIES_ALIAS_g(2) = 'Vapor'

!  MW_g - Obtained from Burcat and Ruscic databse
!  MW_AVG - Calculated from individual species

# PARTICLE SECTION
#------------------------------------------//

  EP_star = 0.40    ! Packed bed void fraction
  e       = 0.9
  Phi     = 30.0
  C_f     = 0.1

  MMAX = 1

! Solids phase 1
!------------------------------------------//
  D_p0 = 0.29     ! (cm)
  RO_s0= 0.9586d0 ! (g/cm)


#_______________________________________________________________
# INITIAL CONDITIONS SECTION

  IC_X_w(1) = 0.0
  IC_X_e(1) = 1.0

  IC_Y_s(1) = 0.0
  IC_Y_n(1) = 1.0

  IC_Z_b(1) = 0.0
  IC_Z_t(1) = 1.0

  IC_EP_g(1) = 1.0
  IC_T_g(1)  = 353.15     ! (K) --> 80C
  IC_P_g(1)  = 1.01325d6 ! -> 1atm

  IC_U_g(1) = 191.0  ! (cm/sec)
  IC_V_g(1) = 0.0   ! (cm/sec)
  IC_W_g(1) = 0.0   ! (cm/sec)

  IC_X_g(1,1) = 0.644516  ! Air
  IC_X_g(1,2) = 0.355484  ! Water vapor



#_______________________________________________________________
# BOUNDARY CONDITIONS SECTION


# Gas Inlet
#------------------------------------------//
  BC_X_w(1)  = 0.0
  BC_X_e(1)  = 0.0
  BC_Z_b(1)  = 0.0
  BC_Z_t(1)  = 1.0
  BC_Y_s(1)  = 0.0
  BC_Y_n(1)  = 1.0

  BC_TYPE(1) = 'MI'

  BC_P_g(1)  = 1.01325d6   ! (Barye) -> 1 atm
  BC_T_g(1)  = 353.15      ! (K) --> 30C
  BC_EP_g(1) = 1.0
                                                                                
  BC_V_g(1)  = 0.0
  BC_W_g(1)  = 0.0

  BC_X_g(1,1) = 0.644516  ! Air
  BC_X_g(1,2) = 0.355484  ! Water vapor

  BC_MassFlow_g(1) = 0.156989 ! g/sec


# Free-slip Walls
#------------------------------------------//
  BC_X_w(2)  =  0.0   0.0   0.0   0.0
  BC_X_e(2)  =  1.0   1.0   1.0   1.0
  BC_Z_b(2)  =  0.0   1.0   0.0   0.0
  BC_Z_t(2)  =  0.0   1.0   1.0   1.0
  BC_Y_s(2)  =  0.0   0.0   0.0   1.0
  BC_Y_n(2)  =  1.0   1.0   0.0   1.0

  BC_TYPE(2) = 4*'FSW'

  BC_hw_T_g(2) =  4*0.0
  BC_C_T_g(2)  =  4*0.0

  BC_hw_X_g(2,1) =  4*0.0
  BC_hw_X_g(2,2) =  4*0.0

  BC_C_X_g(2,1) =  4*0.0
  BC_C_X_g(2,2) =  4*0.0


  BC_hw_T_s(2,1) =  4*0.0
  BC_C_T_s(2,1)  =  4*0.0

  BC_hw_X_s(2,1,1) =  4*0.0

  BC_C_X_s(2,1,1) =  4*0.0


# Gas-Solids Outlet
#------------------------------------------//
  BC_X_w(6) = 1.0
  BC_X_e(6) = 1.0
  BC_Z_b(6) = 0.0
  BC_Z_t(6) = 1.0
  BC_Y_s(6) = 0.0 
  BC_Y_n(6) = 1.0
                  
  BC_TYPE(6) = 'PO'

  BC_P_g(6)  = 1.01325d6  ! (Barye)
  BC_T_g(6)  = 353.15   ! (K) -> 80C

#_______________________________________________________________
# OUTPUT CONTROL SECTION

  OUT_DT = 5.0
  RES_DT = 0.1 

  SPX_DT(1) = 0.1    ! EP_g 
  SPX_DT(2) = 5.0    ! P_g, P_star 
  SPX_DT(3) = 0.1    ! U_g, V_g, W_g
  SPX_DT(4) = 500.   ! U_s, V_s, W_s
  SPX_DT(5) = 500.   ! ROP_s
  SPX_DT(6) = 0.1    ! T_g, T_s
  SPX_DT(7) = 0.1    ! X_g, X_s
  SPX_DT(8) = 500.   ! theta
  SPX_DT(9) = 500.   ! Scalar

  RESID_STRING  = 'P0' 'T0'

  NLOG = 25
  FULL_LOG = .F. 

  WRITE_DASHBOARD = .T.

#_______________________________________________________________
# PARALLELIZATION CONTROLS

  NODESI  = 1     NODESJ  = 1     NODESK  = 1


#_______________________________________________________________
# DISCRETE ELEMENT MODEL

  DISCRETE_ELEMENT      = .T.
  DES_CONTINUUM_COUPLED = .T.

  DIMN = 3

  DES_INTERP_ON  = .F.
  WALLDTSPLIT    = .T.

! Solve DES Energy Equations
  DES_ENERGY_EQ = .T. 
    DES_CONV_EQ = .T. ! Calculate particle-gas convective heat trans.
    DES_COND_EQ = .F. ! Single particle, skip conduction
    DES_RADI_EQ = .F. ! Low temperatures, skip radiation
 
! Solve DES Species Equations
  DES_SPECIES_EQ = .T.

  DEBUG_DES  = .F.

  DTSOLID_FACTOR  = 0.1D0 ! Ratio (fluid step/solid steps)

! Constant particle size, changing density.
  REACTION_MODEL = 'VARIABLE_DENSITY'


# DES Particle Properties
#------------------------------------------//
  PARTICLES  = 1 ! Number of partiles in the system.

  DES_NMAX_s(1) = 1

  DES_SPECIES_s(1,1) = 'H2O(L)'
  DES_SPECIES_ALIAS_s(1,1) = 'Liquid'

  DES_K_s0  = 1.4651d-3  ! conductivity, cal/(sec.cm.K)
! DES_MW_s - molecular weight obtained from THERMO DATA


#_______________________________________________________________
# CHEMICAL REACTION SECTION

  @(DES_RXNS)

    Evaporation{ chem_eq = "Vapor --> Liquid"}

  @(DES_END)


# DES Initial Condition
#------------------------------------------//
  DES_IC_X_w   = 0.0
  DES_IC_X_e   = 1.0
  DES_IC_Y_s   = 0.0
  DES_IC_Y_n   = 1.0
  DES_IC_Z_b   = 0.0
  DES_IC_Z_t   = 1.0

  DES_IC_T_s(1,1)   = 289.15 ! Temperature
  DES_IC_X_s(1,1,1) = 1.0    ! Liquid Water


# DES Boundary Condition
#------------------------------------------//
  DES_PERIODIC_WALLS  = .F.


# Neighbor Search Parameters
#------------------------------------------//
  DES_NEIGHBOR_SEARCH  = 1 ! Particle neighbor search method
!   [1] : N-Square7
!    4  : Cell linked-list based algorithm

! solids time steps between neighbor search
  NEIGHBOR_SEARCH_N = 987654321


  MN  = 20  ! Maximum number of neighbors


# Particle/Particle/Wall Contact Parameters
#------------------------------------------//

  KN       = 1.0d6        ! Normal inter-particle collision spring constant
  KT_FAC   = @(2.0/7.0)   ! Tangential spring factor = KT/KN   [2/7]
  KN_W     = 1.0d6        ! Normal particle-wall collision spring constant
  KT_W_FAC = @(2.0/7.0)   ! Tangential spring factor = KT_W/KN_W   [2/7]
  MEW      = 0.1          ! Inter-particle friction coeffienct
  MEW_W    = 0.1          ! Particle-wall friction coefficient

  DES_EN_INPUT(1)   =  0.9
  DES_EN_WALL_INPUT =  0.9

  DES_ETAT_FAC    = @(1/2)
  DES_ETAT_W_FAC  = @(1/2)


# DES Output Control
#------------------------------------------//

  PRINT_DES_DATA = .F. ! write DEM data : *.vtp files
  DES_RES_DT = 5.0       
  DES_SPX_DT = 0.5       ! interval to write *.vtp files in pure DEM simulation


#_______________________________________________________________
THERMO DATA

H2O(L)            L 8/89H  2.O  1.   0.   0.L   273.150  6000.000  C  18.01528 1
 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00 0.00000000E+00    2
 0.00000000E+00 0.00000000E+00 7.25575005E+01-6.62445402E-01 2.56198746E-03    3
-4.36591923E-06 2.78178981E-09-4.18865499E+04-2.88280137E+02-3.43772513E+04    4

