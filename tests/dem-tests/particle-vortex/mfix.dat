########################################################################
#                                                                      #
# Author:  Sreekanth Pannala                            Date: 01-2010  #
# Modified: J. Musser                                   Date: 05-2014  #
#                                                                      #
#  References:                                                         #
#                                                                      #
#  R. Garg, J. Galvin, T. Li, and S. Pannala, Documentation of open-   #
#     source MFIX-DEM software for gas-solids flows," from URL:        #
#     https://mfix.netl.doe.gov/documentation/dem_doc_2012-1.pdf,      #
#                                                                      #
########################################################################


#_______________________________________________________________________
# RUN CONTROL SECTION

  RUN_NAME    = 'DEM_PV'
  DESCRIPTION = 'DEM Test: Particles in vortex'

  RUN_TYPE = 'NEW'
  UNITS    = 'SI'

  TIME  = 0.0      ! start time
  TSTOP = 5.0      ! stop time

  DT     = 2.0d-4  ! time step
!  DT_FAC = 1.0     ! fixed step size
  DT_MIN = 1.0d-30

  ENERGY_EQ  = .T.
  SPECIES_EQ = .F.   .F.

  MOMENTUM_X_EQ(0) = .F. .F.
  MOMENTUM_Y_EQ(0) = .F. .F.

  GRAVITY = 0.0

  CALL_USR = .T.

  DRAG_TYPE = 'WEN_YU'

  DES_CONTINUUM_COUPLED = .T.
  DES_INTERP_ON=.T.


#_______________________________________________________________________
# NUMERICAL SECTION

  MAX_NIT = 250
  TOL_RESID = 1.E-3

  LEQ_SWEEP(1) = 9*'ISIS'


#_______________________________________________________________________
# GEOMETRY SECTION

  COORDINATES = 'CARTESIAN'

  XLENGTH =  1.0d-2   IMAX = 32
  YLENGTH =  1.0d-2   JMAX = 32
  ZLENGTH =  1.0d-4   NO_K = .T.

  CYCLIC_X = .T.
  CYCLIC_Y = .T.


#_______________________________________________________________________
# MATERIAL SECTION

! Gas Section
!---------------------------------------------------------------------//
  MU_g0 = 1.0d-6   ! constant gas viscosity
  RO_g0 = 1.2      ! constant gas density

  K_g0  = 1E-4        ! (cal/(sec.cm.K))
  C_Pg0 = 2.3878E-1  ! (cal/(g.K))


! Particle Section
!---------------------------------------------------------------------//
  MMAX = 1

  PARTICLES = 625

! Particle-particle:
  KN =   8.0d1               ! Normal collision spring constant
  DES_EN_INPUT = 0.8         ! Restitution coefficient
  MEW   = 0.2                ! Friction coefficient

! Particle-wall:
  KN_W = 8.0d1               ! Normal collision spring constant
  DES_EN_WALL_INPUT = 0.8    ! Restitution coefficient
  MEW_W = 0.1                ! Friction coefficient

  NFACTOR = 0                ! No initial settling

  DES_NEIGHBOR_SEARCH =   4  ! Grid based neighbor search
  NEIGHBOR_SEARCH_N   =   1  ! Steps between neighbor search
  MN = 14


! Solids phase 1:
!---------------------------------------------------------------------//
  SOLIDS_MODEL = 'DEM'

  RO_s0 = 1.8d+3     ! density
  D_p0  = 1.0d-4     ! diameter

  K_s0(1) =   1E-03     ! Conductivity  :: cal/(sec.cm.K)
  C_ps0(1) =  0.191204  ! Specific Heat :: cal/(g.K)
  DES_Em(1) = 0.0       ! Emmisivity


#_______________________________________________________________________
# INITIAL CONDITIONS SECTION

  IC_X_w(1)   =   0.0
  IC_X_e(1)   =   1.0d-2
  IC_Y_s(1)   =   0.0
  IC_Y_n(1)   =   1.0d-2

  IC_EP_g(1)  =   1.0   ! void fraction

  IC_U_g(1)   =   0.0   ! x-dir gas velocity
  IC_V_g(1)   =   0.0   ! y-dir gas velocity


  IC_T_g(1)   =    350.0
  IC_T_s(1,1) =    298.15 ! Temperature of cold particle (K) -> 25C

#_______________________________________________________________________
# BOUNDARY CONDITIONS SECTION

! No boundaries. The domain is 2D and fully periodic.


#_______________________________________________________________________
# OUTPUT CONTROL SECTION

  FULL_LOG = .T.    ! display residuals on screen
  NLOG = 25         ! frequency to updated log file (.LOG)

! Output Control
  RES_DT =  0.01   ! frequency to write restart file (.RES)

  SPX_DT    =   0.05  ! EPg
  SPX_DT(2) = 8*1.00  ! Everything else

  PRINT_DES_DATA = .T.


#_______________________________________________________________________
# DMP SETUP

! MPI partition
  NODESI = 4   NODESJ = 4   NODESK = 1

  ENABLE_DMP_LOG = .F.
  CHK_BATCHQ_END = .F.
