#
# Pure DEM
#
# Description: One particle freely falling under gravity and
# colliding with a wall.  Based on the work of Chen et al.,
# International Journal of Geomechanics, 2007


# Run-control section
  RUN_NAME = 'DES_PFF'
  DESCRIPTION = 'particle free fall'
  RUN_TYPE = 'new'
  UNITS = 'cgs'
  TIME  =0.0  TSTOP = 0.05
  DT = 1.0e-4
  DT_MAX = 2E-4
  ENERGY_EQ = .FALSE.
  SPECIES_EQ = .FALSE.    .FALSE. !.FALSE.    .FALSE.
  MOMENTUM_X_EQ = .FALSE.  .FALSE.
  MOMENTUM_Y_EQ = .FALSE.  .FALSE.
  MOMENTUM_Z_EQ = .FALSE.  .FALSE.

  CALL_USR = .TRUE.

# Numeric Section
  DISCRETIZE = 9*2
  MAX_NIT = 500


# Geometry Section
  COORDINATES = 'Cartesian'
  XLENGTH  = 30    IMAX = 1
  YLENGTH  = 80    JMAX = 4
  ZLENGTH  = 30    KMAX = 1
  NO_K     = .FALSE.

  USE_STL = .T.
  STL_BC_ID = 3

# Gas-phase Section
  RO_g0 = 0.0
  MU_g0 = 2E-1


# Solids-phase Section
! when using DEM the variable MMAX is used, when using DEM with
! gener_part_config then RO_S0(M) and D_p0(M) are also used (they
! are otherwise read in from particle_input.dat).  whether used
! or not, the following quantities must be defined to bypass the
! checks made in MFIX
  SOLIDS_MODEL(1) = 'DEM'
  MMAX    = 1
  RO_s0   = 4.0
  D_p0    = 0.5
  e       = 0.9
  Phi     = 0.0
  EP_star = 0.43


# Initial Conditions Section
       !
  IC_X_w(1)         =   0.0
  IC_X_e(1)         =  30.0
  IC_Y_s(1)         =   0.0
  IC_Y_n(1)         =  80.0
  IC_Z_b(1)         =   0.0
  IC_Z_t(1)         =  30.0
  IC_EP_g(1)        =   1.0

  IC_U_g(1)         =   0.0
  IC_V_g(1)         =   1.0
  IC_W_g(1)         =   0.0
  IC_U_s(1,1)       =   0.0
  IC_V_s(1,1)       =   0.0
  IC_W_s(1,1)       =   0.0
  IC_P_g(1)         =   1.013E6
  IC_T_g(1)         = 273.


# Boundary Conditions Section
  ! Flow boundary conditions
       !               Top
  BC_X_w            =   0.0
  BC_X_e            =  30.0
  BC_Y_s            =  80.0
  BC_Y_n            =  80.0
  BC_Z_b            =   0.0
  BC_Z_t            =  30.0
  BC_TYPE           =  'PO'

!  BC_EP_g           =   1.0
  BC_P_g            =   1.013E6

  ! Wall boundary conditions
       !              bottom
!  BC_X_w(2)         =  0.0
!  BC_X_e(2)         = 30.0
!  BC_Y_s(2)         =  0.0
!  BC_Y_n(2)         =  0.0
!  BC_TYPE(2)        =  'FSW'

!  BC_JJ_PS(2)       = 0
!  BC_Uw_g(2)        = 0.0
!  BC_Vw_g(2)        = 0.0
!  BC_Ww_g(2)        = 0.0
!  !BC_hw_g(2)       = 0.0
!  BC_Uw_s(2,1)      = 0.0
!  BC_Vw_s(2,1)      = 0.0
!  BC_Ww_s(2,1)      = 0.0
!  BC_hw_s(2,1)      = 0.0


# Output Control
  OUT_DT                = 10.           !write text file R.OUT (every xx s)
  RES_DT                = 0.01          !write binary restart file (R.RES every xx s)
  NLOG                  = 100           !write logfile R.LOG (every xx time steps)
  FULL_LOG              = .TRUE.        !display residuals on screen

!  SPX_DT values determine how often SPx files are written.
!  gas and solids pressure (P_g, P_star), is written every 0.1 s, and so forth.
!  1 = EP_g,   2= P_g & P_star,  3 = U_g, V_g, & W_g,  4 = U_s, V_s, & W_s
!  5 = ROP_s,  6 = T_g, T_sM,    7 = X_g, X_s,         8 = ThetaM
!  9 = scalar, 10(A) = rrate,    11(B)=k_epsilon

  SPX_DT    = 0.001
  SPX_DT(2) =  .1      .1     .1     .1     .1     100.    100.  100.

  RESID_STRING = 'P0' 'P1' 'U0' 'U1' 'V0' 'V1' 'G1'  ! display residuals


# DMP control
  NODESI = 1   NODESJ = 1   NODESK = 1


# DES
  DES_CONTINUUM_COUPLED = .F.   ! false by default
  DES_NEIGHBOR_SEARCH = 1   ! Particle neighbor search method:
                            ! 1=n-square; 2=quadtree; 3=octree; 4=gridbased
  MN = 2                    ! Maximum number of neighbors allowed per particle
  NEIGHBOR_SEARCH_N = 1     ! ~Maximum number of steps through DEM loop before
                            ! neighbor search is performed (default=25)

  PARTICLES = 7

  KN       = 1.72D10       ! Normal inter-particle collision spring constant
  KT_FAC   = 0.86         ! Tangential spring factor = KT/KN

  KN_W     = 1.72D10       ! Normal particle-wall collision spring constant
  KT_W_FAC = 0.86         ! Tangential spring factor = KT_W/KN_W

  MEW      = 0.092         ! Inter-particle friction coeffienct
  MEW_W    = 0.092         ! Particle-wall friction coefficient

  DES_EN_INPUT      = 0.9     ! particle-particle rest coef
  DES_ETAT_FAC      = @(1/2)  ! damping coefficient factor = ETAT/ETAN

  DES_EN_WALL_INPUT = 0.9     ! particle-wall rest coef
  DES_ETAT_W_FAC    = @(1/2)  ! damping coefficient factor = ETAT_W/ETAN_W


  PRINT_DES_DATA = .TRUE.
  DES_SPX_DT = 0.20
  DES_RES_DT = 1.0


