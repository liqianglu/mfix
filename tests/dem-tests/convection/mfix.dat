# Run-control section
# -----------------------------
  RUN_NAME = 'CONV_VV' 
  DESCRIPTION = 'single particle in uniform gas flow'
  RUN_TYPE = 'new'
  UNITS = 'cgs'
  TIME  =  0.0 
  TSTOP = 25.0
  DT = 1.0e-4
  DT_MAX = 2E-4

  ENERGY_EQ = .TRUE.
  SPECIES_EQ = .FALSE. .FALSE. .FALSE.

! value of momentum_()_eq for solid phases do not matter when
! conducting dem simulations
  MOMENTUM_X_EQ = .FALSE. .FALSE. .FALSE.
  MOMENTUM_Y_EQ = .FALSE. .FALSE. .FALSE.
  MOMENTUM_Z_EQ = .FALSE. .FALSE. .FALSE.

  DRAG_TYPE = 'WEN_YU'

  GRAVITY = 980.665D0    ! [980.665d0 in set_constants]

  CALL_USR = .T.

# Geometry Section
# -----------------------------
  COORDINATES = 'Cartesian'
  XLENGTH  =  12.0    IMAX =  3
  YLENGTH  = 120.0    JMAX = 30
! for coupled dem simulations a defined 'depth' (i.e. zlength) is needed 
! even when conducting 2D simulations (spheres in a plane) for calculating
! void fraction
  ZLENGTH  = 0.36
  NO_K     = .TRUE.

# Numeric
# -----------------------------
  MAX_NIT = 500
  TOL_RESID = 1.0E-2

! The sweep direction used in the linear equation solver. The sweep 
! direction for preconditioning line relation:
!      ISIS  : 1 sweep with do IK loop followed by send_recv
!     [RSRS] : 1 red-black sweep with do IK loop followed by send_recv 
!      ASAS  : 1 red-black sweep with do IK loop followed by do JK
!                followed by IJ followed by send_recv
  LEQ_SWEEP = 9*'ISIS'   


# Gas-phase Section
# -----------------------------
  RO_g0 = 1.1854E-3  ! g/cm^3
  MU_g0 = 1.8603E-4  ! g/(cm.s)
  K_g0  = 1.2396E-4  ! cal/(s.g.K)
  C_Pg0 = 2.3878E-1  ! cal/(g.K) 


# Solids-phase Section
# -----------------------------
  MMAX     = 2
  RO_s     = 0.42    8.85
  D_p0     = 0.30    0.36

! e must be defined, even in DEM simulations where it is not used
  e        = 0.9

! phi must be set if MMAX >0, however, it is only used if schaeffer 
! or friction models are invoked
  Phi     = 0.0 
  EP_star = 0.40  

! if MMAX>1 and using default KT_TYPE [undefined] then C_F must be set 
! even if not used as in DEM case
  C_f     = 0.1          


# Boundary Conditions Section
# -----------------------------
  BC_X_w(1)   =    0.0  ! Uniform inlet
  BC_X_e(1)   =   12.0
  BC_Y_s(1)   =    0.0
  BC_Y_n(1)   =    0.0
  BC_TYPE     =    'MI'

  BC_EP_g(1)  =    1.0
  BC_U_g(1)   =    0.0
  BC_V_g(1)   =  600.0
  BC_P_g(1)   =    0.0
  BC_T_g(1)   =  298.15

  BC_X_w(2)   =    0.0  ! Exit
  BC_X_e(2)   =   12.0
  BC_Y_s(2)   =  120.0
  BC_Y_n(2)   =  120.0
  BC_TYPE(2)  =    'PO' ! specified pressure outflow
  BC_P_g(2)   =    0.0


# Initial Conditions Section
# -----------------------------
  IC_X_w(1)   =    0.0
  IC_X_e(1)   =   12.0
  IC_Y_s(1)   =    0.0
  IC_Y_n(1)   =  120.0

  IC_EP_g(1)  =    1.0           
 
  IC_U_g(1)   =    0.0           
  IC_V_g(1)   =  600.0

  IC_T_g(1)   =  298.15


#  Output Control
# -----------------------------
  RES_DT = 1.0     ! interval at which restart (.RES) file is updated
  OUT_DT = 1.0     ! interval at which standard output (.OUT) file is updated
  NLOG = 25          ! interval in no. of time steps at which (.LOG) file is written

! Interval at which .SPX files are written 
  SPX_DT(1)  = 1.0     ! Void fraction (EP_g)
  SPX_DT(2)  = 100.0     ! Gas and solids pressure (P_g, P_star)
  SPX_DT(3)  = 100.0     ! Gas velocity (U_g, V_g, W_g)
  SPX_DT(4)  = 100.0     ! Solids velocity (U_s, V_s, W_s)
  SPX_DT(5)  = 100.0     ! Solids density (ROP_s)
  SPX_DT(6)  =   1.0     ! Gas and solids temp. (T_g, T_s1, T_s2)
  SPX_DT(7)  = 100.0     ! Gas and solids mass fractions (X_g, X_s)
  SPX_DT(8)  = 100.0     ! Granular Temperature (G)
  SPX_DT(9)  = 100.0     ! User defined scalars

  FULL_LOG = .FALSE.               ! display residuals on screen
  RESID_STRING = 'P0' 'U0' 'V0'   ! which residuals to display


# DMP control
# -----------------------------
  NODESI = 1 
  NODESJ = 1
  NODESK = 1


#  DES
# -----------------------------
  DISCRETE_ELEMENT = .TRUE. 

  DES_CONTINUUM_COUPLED = .TRUE.  ! decide whether gas and solids are 
                                   ! coupled [FALSE]

  WALLDTSPLIT = .TRUE.  ! treat wall interaction as two-particle interaction 
                        ! but accounting for wall properties; must be true 
                        ! for DEM [FALSE]
  DES_INTERP_ON = .TRUE.

  DIMN = 2    ! if no_k, then DIMN is set to 2 otherwise it undefined by default
  PARTICLES = 2

# DES Heat Transfer
! -----------------------------
! Solve energy equations for DES [.FALSE.]
  DES_ENERGY_EQ = .TRUE.
    DES_CONV_EQ = .TRUE.
    DES_COND_EQ = .FALSE.
    DES_RADI_EQ = .FALSE.

!              Cold       Hot
  DES_K_s0 =  0.131453  0.002008  ! Conductivity  :: cal/(sec.cm.K)
  DES_C_ps0 = 0.191204  0.013145  ! Specific Heat :: cal/(g.K)
  DES_Em =    0.8       0.8       ! Emmisivity

# DES Initial Conditions
! -----------------------------
  DES_IC_X_w(1)  =   0.0           
  DES_IC_X_e(1)  =   12.0           
  DES_IC_Y_s(1)  =   0.0           
  DES_IC_Y_n(1)  = 120.0

  DES_IC_T_s(1,1) =  298.15 ! Temperature of bed particles (K) -> 25C
  DES_IC_T_s(1,2) =  373.15 ! Temperature of hot particle (K) -> 180C

! -----------------------------
  DES_NEIGHBOR_SEARCH =  4    ! Particle neighbor search method: [1]=n-square;
                              ! 2=quadtree; 3=octree; 4=cell based grid search

! the following are used only when des_neighbor_search=4 
! used to define the grid mesh used for the neighbor search
  DESGRIDSEARCH_IMAX =  6    ! no. of i (x) cells on neighbor search grid 
  DESGRIDSEARCH_JMAX =  30   ! no. of j (y) cells
!  DESGRIDSEARCH_KMAX = 3     ! no. of k (z) cells

  NEIGHBOR_SEARCH_N  = 10    ! ~Maximum number of steps through DEM stage until 
                             ! a neighbor search is performed [25]

  MN = 20    ! Maximum number of neighbors allowed per particle [20]

  KN       = 1.6D7        ! Normal inter-particle collision spring constant
  KT_FAC   = 0.0  !@(2.0/7.0)   ! Tangential spring factor = KT/KN   [2/7]
  KN_W     = 1.6D7        ! Normal particle-wall collision spring constant
  KT_W_FAC = 0.0  !@(2.0/7.0)   ! Tangential spring factor = KT_W/KN_W   [2/7]
  MEW      = 0.0          ! Inter-particle friction coeffienct
  MEW_W    = 0.0          ! Particle-wall friction coefficient

! set the particle-particle restitution coefficient in an array arranged as
  DES_EN_INPUT      = 0.9 0.9    ! e11 e12 e13 e14 e15
  DES_EN_INPUT(3)   = 0.9        ! e22 e23 e24 e25
! particle-wall rest coef arranged in array arranged as
  DES_EN_WALL_INPUT = 0.9 0.9    ! e1w e2w e3w e4w e5w

  DES_ETAT_FAC    = 0  !@(1/2)  ! damping coefficient factor = ETAT/ETAN   [1/2]
  DES_ETAT_W_FAC  = 0  !@(1/2)  ! damping coefficient factor = ETAT_W/ETAN_W   [1/2]

  PRINT_DES_DATA = .FALSE. ! write DEM data : *.vtp files
  DES_RES_DT = 1.0       
  DES_SPX_DT = 1.0       ! interval to write *.vtp files in pure DEM simulation
