########################################################################
#  Author: J.Musser                                 Date:   2012-11-15 #
#                                                                      #
#  Purpose: These simulations are constructed to reflect the classical #
#  wet-bulb phenomenon whereby energy loss from evaporation is offset  #
#  by energy absorption from the environment.                          #
#                                                                      #
########################################################################

  RUN_NAME = 'CONV_VV' 
  DESCRIPTION = 'single particle in uniform gas flow'

#_______________________________________________________________________
# RUN CONTROL SECTION

  RUN_TYPE = 'NEW'
  UNITS = 'CGS'

  TIME =  0.0 
  TSTOP = 5.0

  DT = 1.0e-4
  DT_MAX = 2E-4

  ENERGY_EQ = .T.

  SPECIES_EQ(0:2) = .F. .F. .F.

  MOMENTUM_X_EQ(0:2) = .F. .F. .F.
  MOMENTUM_Y_EQ(0:2) = .F. .F. .F.
  MOMENTUM_Z_EQ(0:2) = .F. .F. .F.

  DRAG_TYPE = 'WEN_YU'

  CALL_USR = .T.

  DES_CONTINUUM_COUPLED = .T.
  DES_INTERP_ON = .T.


#_______________________________________________________________________
# NUMERICAL SECTION

  MAX_NIT = 50
  TOL_RESID = 1.0E-2

  LEQ_SWEEP = 9*'ISIS'   


#_______________________________________________________________________
# GEOMETRY SECTION 

  COORDINATES = 'CARTESIAN'

  XLENGTH  =  12.0    IMAX =  3
  YLENGTH  = 120.0    JMAX = 30
  ZLENGTH  =   0.36   NO_K = .T.


! Grid partition for DES grid
  DESGRIDSEARCH_IMAX = 1 
  DESGRIDSEARCH_JMAX = 1
  DESGRIDSEARCH_KMAX = 1


#_______________________________________________________________________
# MATERIAL SECTION

! GAS SECTION
!---------------------------------------------------------------------//

  RO_g0 = 1.1854E-3  ! g/cm^3
  MU_g0 = 1.8603E-4  ! g/(cm.s)
  K_g0  = 1.2396E-4  ! cal/(s.g.K)
  C_Pg0 = 2.3878E-1  ! cal/(g.K) 



! PARTICLE SECTION
!---------------------------------------------------------------------//
  MMAX = 2

  PARTICLES = 2   ! Number of partiles in the system.

! Particle-particle:
  KN =   1.6d7                 ! Normal collision spring constant
  MEW =  0.0                   ! Friction coefficient

! Particle-wall
  KN_W =  1.6d7                ! Normal collision spring constant
  MEW_W = 0.0                  ! Friction coefficient

! Restitution coefficients

  DES_EN_INPUT(1:2) = 0.9  0.9 ! e11  e12
  DES_EN_INPUT(3)   =      0.9 !      e22

  DES_EN_WALL_INPUT = 0.9  0.9 ! e1w  e2w

  DES_NEIGHBOR_SEARCH = 4          ! Grid based neighbor search
  NEIGHBOR_SEARCH_N   = 9999   ! Steps between neighbor search
  MN = 20                      ! Maximum number of neighbors

  DES_Em = 0.0       ! Emmisivity


! Solids phase 1
!---------------------------------------------------------------------//
  SOLIDS_MODEL(1) = 'DEM'

  D_p0(1) =   0.30     ! (cm)
  RO_s0(1)=   0.42     ! (g/cm)

  C_ps0(1) =  0.013145 ! Specific Heat :: cal/(g.K)
  K_s0(1) =   0.0      ! Conductivity  :: cal/(sec.cm.K)
  DES_Em(1) = 0.0      ! Emissivity



! Solids phase 1
!---------------------------------------------------------------------//
  SOLIDS_MODEL(2) = 'DEM'
  
  D_p0(2) = 0.36        ! (cm)
  RO_s0(2)= 8.85        ! (g/cm)

  C_ps0(2) =  0.013145  ! Specific Heat :: cal/(g.K)
  K_s0(2) =   0.0       ! Conductivity  :: cal/(sec.cm.K)
  DES_Em(2) = 0.0       ! Emissivity


#_______________________________________________________________________
# INITIAL CONDITIONS SECTION

  IC_X_w(1)   =    0.0
  IC_X_e(1)   =   12.0
  IC_Y_s(1)   =    0.0
  IC_Y_n(1)   =  120.0

  IC_EP_g(1)  =    1.0

  IC_U_g(1)   =    0.0
  IC_V_g(1)   =  600.0

  IC_T_g(1)   =  298.15

  IC_T_s(1,1) =  298.15 ! (K) -> 25C
  IC_T_s(1,2) =  373.15 ! (K) -> 180C

# Boundary Conditions Section
# -----------------------------
  BC_X_w(1)   =    0.0  ! Uniform inlet
  BC_X_e(1)   =   12.0
  BC_Y_s(1)   =    0.0
  BC_Y_n(1)   =    0.0
  BC_TYPE     =    'MI'

  BC_EP_g(1)  =    1.0
  BC_U_g(1)   =    0.0
  BC_V_g(1)   =  600.0
  BC_P_g(1)   =    0.0
  BC_T_g(1)   =  298.15

  BC_X_w(2)   =    0.0  ! Exit
  BC_X_e(2)   =   12.0
  BC_Y_s(2)   =  120.0
  BC_Y_n(2)   =  120.0
  BC_TYPE(2)  =    'PO' ! specified pressure outflow
  BC_P_g(2)   =    0.0



#  Output Control
# -----------------------------
  RES_DT = 1.0     ! interval at which restart (.RES) file is updated
  NLOG = 25        ! interval in no. of time steps at which (.LOG) file is written

! Interval at which .SPX files are written 
  SPX_DT(1)  = 1.0     ! Void fraction (EP_g)
  SPX_DT(2)  = 100.0     ! Gas and solids pressure (P_g, P_star)
  SPX_DT(3)  = 100.0     ! Gas velocity (U_g, V_g, W_g)
  SPX_DT(4)  = 100.0     ! Solids velocity (U_s, V_s, W_s)
  SPX_DT(5)  = 100.0     ! Solids density (ROP_s)
  SPX_DT(6)  =   1.0     ! Gas and solids temp. (T_g, T_s1, T_s2)
  SPX_DT(7)  = 100.0     ! Gas and solids mass fractions (X_g, X_s)
  SPX_DT(8)  = 100.0     ! Granular Temperature (G)
  SPX_DT(9)  = 100.0     ! User defined scalars

  FULL_LOG = .FALSE.               ! display residuals on screen
  RESID_STRING = 'P0' 'U0' 'V0'   ! which residuals to display


# DMP control
# -----------------------------
  NODESI = 1 
  NODESJ = 1
  NODESK = 1


  PRINT_DES_DATA = .FALSE. ! write DEM data : *.vtp files
  DES_RES_DT = 1.0       
  DES_SPX_DT = 1.0       ! interval to write *.vtp files in pure DEM simulation
