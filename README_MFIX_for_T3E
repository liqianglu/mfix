
Here is the path to be entered when make_mfix asks
for mpif.h header file


/opt/ctl/mpt/mpt/include

issue the command:
ln -s /opt/ctl/mpt/mpt/include/mpif.h mpif.h

( or alternatively you can use
/opt/ctl/mpt/1.4.0.2/include/mpif.h )


Here is a list of things done to compile on Cray:

1) Change machine.f and set the following:
     in subroutine MACHINE_CONS
        NWORDS_DP =  32
        NWORDS_R        =  32
        NWORDS_I        =  64
     in subroutine CPU_TIME
        CPU = IRTC()*6.6E-9

     in subroutine END_LOG
        comment call FLUSH(UNIT_LOG)

     add a dummy subroutine FLUSH(UNIT_LOG)
 
2) Changes in make_mfix:

   -) Added following block for Cray after OSF1) block
      sn6301)
            mach_file="CRAYT3E.F"

            FORTRAN_CMD=f90
            LINK_CMD=f90
            libs_d=""
            libs=""

            OBJ_EXT=o
            FORTRAN_EXT=f
            omp=""
            compile_d="-c -g -f free -d p -e mui -eA -O ieeeconform -M 801"
            link_d="-lapp"

            compile="-c -g -f free -d p -e mui -eA -O ieeeconform -M 801"
            compile2="-c  -g -f free -d p -e mui -eA -eZ -F -DT3E -O ieeeconform -M 801"
            link="-lapp"
            MODULE_CODE=0
            ;; 

   -) Change "model/mfix_u.make" and "model/mfix_u_not.make" to
      force compilation of mpi_utility_mod.f with
       $FORT_FLAGS2 instead of $FORT_FLAGS

      from
              $(FORTRAN_CMD) $(FORT_FLAGS) ./dmp_modules/mpi_utility_mod.f

      to
              $(FORTRAN_CMD) $(FORT_FLAGS2) ./dmp_modules/mpi_utility_mod.f

4) Modify the mpi_utility_mod.f tohave selective interface definitions for
   Cray T3E.

   #ifdef T3E
       <=== new definitions for Cray T3E that used to be included with
            #include "t3e_mpi.inc"
   #else
       <=== origina interface definitions
   #endif

   DO THE SAME CHANGE IN dmp_modules/mpi_donothing/mpi_utility_mod.f

5) Remove USE dbg_util from dmp_modules/debug_mod.f
   IF USING make_mfix or make_post, DO NOT FORGET TO remove DBG_UTIL.mod
   from the dependency list of debug_mod.o compilation directive (done in
   .make file) 
6) 
