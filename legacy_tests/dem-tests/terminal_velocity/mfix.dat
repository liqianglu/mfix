########################################################################
#  DEM - Terminal Velocity                                             #
#                                                                      #
# Author:  Sreekanth Pannala                            Date: 01-2010  #
# Modified: J. Musser                                   Date: 05-2014  #
#                                                                      #
#  Comment: The particle-particle and particle-wall spring constants   #
#  were made very small O(10) so that the test case runs in a few min. #
#  This causes larger errros between the RK4 solution and MFIX, but    #
#  at acceptable levels, percent relative error remains below 0.6% for #
#  velocity and below 0.2% for position.                               #
#                                                                      #
#  References:                                                         #
#                                                                      #
#  R. Garg, J. Galvin, T. Li, and S. Pannala, Documentation of open-   #
#     source MFIX-DEM software for gas-solids flows," from URL:        #
#     https://mfix.netl.doe.gov/documentation/dem_doc_2012-1.pdf,      #
#                                                                      #
########################################################################

#_______________________________________________________________________
# RUN CONTROL SECTION

  RUN_NAME     = 'DEM_TV'
  DESCRIPTION  = 'DEM: Terminal velocity of a freely falling'

  RUN_TYPE = 'NEW'
  UNITS    = 'CGS'

  TIME   = 0.00
  TSTOP  = 0.35
  DT     = 1.00d-3
  DT_MAX = 1.00d-3

  ENERGY_EQ    = .F.
  SPECIES_EQ   = .F.    .F.

  MOMENTUM_X_EQ(1) = .F.
  MOMENTUM_Y_EQ(1) = .F.
  MOMENTUM_Z_EQ(1) = .F.

  CALL_USR = .TRUE.

  GRAVITY = 980.

  DRAG_TYPE = 'WEN_YU'

  DES_CONTINUUM_COUPLED = .T.
  DES_INTERP_ON=.T.
  DES_INTERP_SCHEME = 'GARG_2012'

#_______________________________________________________________________
# NUMERICAL SECTION

  MAX_NIT = 250
  TOL_RESID = 1.E-3

! Sweep Direction
  LEQ_SWEEP(1) = 9*'ISIS'

#_______________________________________________________________________
# GEOMETRY SECTION

  COORDINATES    = 'CARTESIAN'

  XLENGTH =   1.0   IMAX  =   5
  YLENGTH =  10.0   JMAX  =  20
  ZLENGTH =   1.0   KMAX  =   5

  DESGRIDSEARCH_IMAX = 1
  DESGRIDSEARCH_JMAX = 1
  DESGRIDSEARCH_KMAX = 1

#_______________________________________________________________________
# MATERIAL SECTION


! Gas Section
!---------------------------------------------------------------------//
  MU_g0 = 1.8d-4   ! constant gas viscosity
  RO_g0 = 1.2d-3   ! constant gas density

! Particle Section
!---------------------------------------------------------------------//
  MMAX = 1

  PARTICLES = 1

! Particle-particle:
  KN =   1.0d1             ! Normal collision spring constant
  DES_EN_INPUT = 0.8       ! Restitution coefficient
  MEW   = 0.2              ! Friction coefficient

! Particle-wall:
  KN_W = 1.0d1             ! Normal collision spring constant
  DES_EN_WALL_INPUT = 0.8  ! Restitution coefficient
  MEW_W = 0.1              ! Friction coefficient

  NFACTOR = 0              ! No initial settling

! Solids phase 1:
!---------------------------------------------------------------------//
  SOLIDS_MODEL = 'DEM'

  RO_s0 = 2.0    ! density
  D_p0 = 0.01d0  ! diameter


#_______________________________________________________________________
# INITIAL CONDITIONS SECTION

  IC_X_w(1)   =   0.0 
  IC_X_e(1)   =   1.0 
  IC_Y_s(1)   =   0.0
  IC_Y_n(1)   =  10.0
  IC_Z_b(1)   =   0.0
  IC_Z_t(1)   =   1.0

  IC_EP_g(1)  =   1.0   ! void fraction

  IC_U_g(1)   =   0.0   ! x-dir gas velocity
  IC_V_g(1)   =  40.0   ! y-dir gas velocity
  IC_W_g(1)   =   0.0   ! z-dir gas velocity

  IC_U_s(1,1) =   0.0
  IC_V_s(1,1) =   0.0
  IC_W_s(1,1) =   0.0

#_______________________________________________________________________
# BOUNDARY CONDITIONS SECTION


! Inlet and Outlet:
!---------------------------------------------------------------------//
  BC_X_w(1)  =   0.0    0.0
  BC_X_e(1)  =   1.0    1.0
  BC_Y_s(1)  =   0.0   10.0
  BC_Y_n(1)  =   0.0   10.0
  BC_Z_b(1)  =   0.0    0.0
  BC_Z_t(1)  =   1.0    1.0

  BC_TYPE(1) =  "MI"   "PO"

  BC_P_g(1)   =  0.0    0.0

  BC_EP_g(1) =   1.0

  BC_U_g(1)   =  0.0
  BC_V_g(1)   = 40.0
  BC_W_g(1)   =  0.0


! Free slip walls:
!---------------------------------------------------------------------//
  BC_TYPE(3) = 4*'FSW'

  BC_X_w(3)  =   0.0    0.0    0.0    1.0
  BC_X_e(3)  =   1.0    1.0    0.0    1.0
  BC_Y_s(3)  =   0.0    0.0    0.0    0.0
  BC_Y_n(3)  =  10.0   10.0   10.0   10.0
  BC_Z_b(3)  =   0.0    1.0    0.0    0.0
  BC_Z_t(3)  =   0.0    1.0    1.0    1.0


#_______________________________________________________________________
# OUTPUT CONTROL SECTION

  FULL_LOG = .T.    ! display residuals on screen
  NLOG = 25         ! frequency to updated log file (.LOG)

! Output Control
  RES_DT = 0.01     ! frequency to write restart file (.RES)
  SPX_DT = 9*1.0    ! frequency to updated data fliles (.SPx)

  PRINT_DES_DATA = .F.


#_______________________________________________________________________
# DMP SETUP

  NODESI = 1   NODESJ = 1   NODESK = 1

  ENABLE_DMP_LOG = .F.
  CHK_BATCHQ_END = .F.
